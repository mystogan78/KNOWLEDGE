{% extends 'base.html.twig' %}

{% block title %}Toutes les le√ßons{% endblock %}

{% block body %}
<div class="container my-5">
  <h1 class="mb-4 text-center">üìö Liste des le√ßons</h1>

<!-- üé® L√âGENDE DES CAT√âGORIES -->
<div class="lesson-legend d-flex justify-content-center gap-4 mb-4 flex-wrap">

  <div class="legend-item">
    <span class="legend-dot bg-informatique"></span> 
    <i class="bi bi-laptop me-1"></i> Informatique
  </div>

  <div class="legend-item">
    <span class="legend-dot bg-musique"></span>
    <i class="bi bi-music-note-beamed me-1"></i> Musique
  </div>

  <div class="legend-item">
    <span class="legend-dot bg-jardinage"></span>
    <i class="bi bi-flower3 me-1"></i> Jardinage
  </div>

  <div class="legend-item">
    <span class="legend-dot bg-cuisine"></span>
    <i class="bi bi-egg-fried me-1"></i> Cuisine
  </div>

</div>

  
  {% if lessons is defined and lessons|length > 0 %}
    <div class="row g-4">
      {% for lesson in lessons %}
        {% set catSlug = lesson.course.category.slug|default('autre') %}

        <div class="col-md-6 col-lg-4">
          <div class="card h-100 shadow-sm border-0 lesson-card lesson-card--{{ catSlug }}">
            <div class="card-body d-flex flex-column">

              <!-- üè∑Ô∏è Titre de la le√ßon -->
              <h5 class="card-title mb-2">{{ lesson.title }}</h5>
              
 




              <!-- üìò Lien vers le cursus -->
              {% if lesson.course %}
                <p class="small mb-2">
                  Cursus :
                  <a href="{{ path('course_show', { slug: lesson.course.slug }) }}" class="text-decoration-underline">
                    {{ lesson.course.title }}
                  </a>
                </p>
              {% endif %}

              <!-- üìù Introduction de la le√ßon -->
              {% if lesson.introText %}
                <div class="card-text flex-grow-1 lesson-intro">
                  {{ lesson.introText|striptags|u.truncate(130, '‚Ä¶') }}
                </div>
              {% endif %}

              <!-- üí∞ Prix et bouton -->
              <div class="d-flex justify-content-between align-items-center mt-3">
                <span class="badge lesson-badge--{{ catSlug }} fs-6">
                  {{ lesson.price|default('0.00') }} ‚Ç¨
                </span>
                <a href="{{ path('lesson_show', { slug: lesson.slug }) }}" class="btn btn-outline-light btn-sm">
                  Voir la le√ßon
                </a>
              </div>

            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-info text-center mt-5">
      Aucune le√ßon n‚Äôa encore √©t√© ajout√©e.
    </div>
  {% endif %}
</div>
{% endblock %}
